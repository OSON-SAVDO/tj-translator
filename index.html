<!DOCTYPE html>
<html lang="tg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Translator Pro</title>
    <style>
        :root {
            --primary: #1a73e8;
            --bg: #f8f9fa;
            --card: #ffffff;
            --text: #3c4043;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* –ü–∞–Ω–µ–ª–∏ –±–æ–ª–æ */
        .header {
            width: 100%;
            max-width: 500px;
            background: var(--card);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-sizing: border-box;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        select {
            border: none;
            font-size: 16px;
            font-weight: 600;
            color: var(--primary);
            background: none;
            outline: none;
            cursor: pointer;
        }

        .swap-btn {
            font-size: 22px;
            background: none;
            border: none;
            color: #5f6368;
            cursor: pointer;
            transition: 0.3s;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –∞—Å–æ—Å”£ */
        .container {
            width: 95%;
            max-width: 500px;
            margin-top: 15px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .card {
            background: var(--card);
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 1px 2px rgba(60,64,67,0.3);
        }

        textarea {
            width: 100%;
            height: 140px;
            border: none;
            resize: none;
            font-size: 18px;
            outline: none;
            font-family: inherit;
            color: #202124;
        }

        .output-box {
            min-height: 140px;
            font-size: 18px;
            color: var(--primary);
            line-height: 1.6;
            word-wrap: break-word;
        }

        /* –¢—É–≥–º–∞“≥–æ–∏ –∏–ª–æ–≤–∞–≥”£ */
        .actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 10px;
            border-top: 1px solid #f1f3f4;
            padding-top: 10px;
        }

        .btn-icon {
            background: none;
            border: none;
            font-size: 22px;
            cursor: pointer;
            color: #5f6368;
            padding: 8px;
            border-radius: 50%;
            transition: 0.2s;
        }

        .btn-icon:active { background: #f1f3f4; }

        .btn-main {
            background: var(--primary);
            color: white;
            border: none;
            padding: 16px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        .recording {
            color: #d93025;
            animation: pulse 1s infinite;
        }

        @keyframes pulse { 50% { opacity: 0.5; } }
    </style>
</head>
<body>

    <div class="header">
        <select id="langFrom">
            <option value="Tajik">–¢–æ“∑–∏–∫”£</option>
            <option value="Russian">–†—É—Å”£</option>
            <option value="English">English</option>
            <option value="Turkish">–¢—É—Ä–∫”£</option>
            <option value="German">–û–ª–º–æ–Ω”£</option>
        </select>

        <button class="swap-btn" onclick="swapLanguages()">‚áÑ</button>

        <select id="langTo">
            <option value="Russian">–†—É—Å”£</option>
            <option value="Tajik">–¢–æ“∑–∏–∫”£</option>
            <option value="English" selected>English</option>
            <option value="Turkish">–¢—É—Ä–∫”£</option>
            <option value="German">–û–ª–º–æ–Ω”£</option>
        </select>
    </div>

    <div class="container">
        <div class="card">
            <textarea id="inputText" placeholder="–ò–Ω “∑–æ –Ω–∞–≤–∏—Å–µ–¥ —ë –º–∏–∫—Ä–æ—Ñ–æ–Ω—Ä–æ –∏—Å—Ç–∏—Ñ–æ–¥–∞ –±–∞—Ä–µ–¥..."></textarea>
            <div class="actions">
                <button class="btn-icon" id="micBtn" onclick="startMic()">üé§</button>
            </div>
        </div>

        <button class="btn-main" onclick="translateWithAI()">‚ú® –¢–ê–†“∂–£–ú–ê –ë–û AI</button>

        <div class="card" style="background-color: #f8f9fa;">
            <div class="output-box" id="outputText">–ù–∞—Ç–∏“∑–∞–∏ —Ç–∞—Ä“∑—É–º–∞...</div>
            <div class="actions">
                <button class="btn-icon" onclick="copyText()">üìã</button>
                <button class="btn-icon" onclick="playText()">üîä</button>
            </div>
        </div>
    </div>

    <script>
        // –ö–∞–ª–∏–¥–∏ Gemini AI-–∏ —à—É–º–æ
        const API_KEY = "AIzaSyBdJybQTGzr1L9SSrMFVOyNXoKtC7OPiIc";

        const input = document.getElementById('inputText');
        const output = document.getElementById('outputText');
        const lFrom = document.getElementById('langFrom');
        const lTo = document.getElementById('langTo');
        const micBtn = document.getElementById('micBtn');

        // –ò–≤–∞–∑ –∫–∞—Ä–¥–∞–Ω–∏ –∑–∞–±–æ–Ω“≥–æ
        function swapLanguages() {
            const temp = lFrom.value;
            lFrom.value = lTo.value;
            lTo.value = temp;
            input.value = "";
            output.innerText = "–ù–∞—Ç–∏“∑–∞–∏ —Ç–∞—Ä“∑—É–º–∞...";
        }

        // –¢–∞—Ä“∑—É–º–∞ –±–æ AI
        async function translateWithAI() {
            const text = input.value.trim();
            if (!text) return;

            output.innerText = "AI —Ñ–∏–∫—Ä –∫–∞—Ä–¥–∞ –∏—Å—Ç–æ–¥–∞–∞—Å—Ç...";
            output.style.color = "#888";

            const prompt = `Translate this text from ${lFrom.value} to ${lTo.value}. Provide ONLY the translation without any explanations: "${text}"`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }]
                    })
                });

                const data = await response.json();
                const result = data.candidates[0].content.parts[0].text;
                
                output.innerText = result.trim();
                output.style.color = "var(--primary)";
            } catch (error) {
                output.innerText = "–•–∞—Ç–æ–≥”£ –¥–∞—Ä –ø–∞–π–≤–∞—Å—Ç—à–∞–≤”£ –±–æ AI. –ò–Ω—Ç–µ—Ä–Ω–µ—Ç—Ä–æ —Å–∞–Ω“∑–µ–¥.";
                output.style.color = "red";
            }
        }

        // –ú–∏–∫—Ä–æ—Ñ–æ–Ω (–û–≤–æ–∑)
        function startMic() {
            const Speech = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (!Speech) return alert("–ë—Ä–∞—É–∑–µ—Ä–∏ —à—É–º–æ –æ–≤–æ–∑—Ä–æ –¥–∞—Å—Ç–≥–∏—Ä”£ –Ω–∞–º–µ–∫—É–Ω–∞–¥!");

            const recognition = new Speech();
            // –¢–∞–Ω–∑–∏–º–∏ –∑–∞–±–æ–Ω–∏ –≥”Ø—à –∫–∞—Ä–¥–∞–Ω
            const langMap = { 'Tajik': 'tg-TJ', 'Russian': 'ru-RU', 'English': 'en-US' };
            recognition.lang = langMap[lFrom.value] || 'en-US';

            recognition.onstart = () => micBtn.classList.add('recording');
            recognition.onend = () => micBtn.classList.remove('recording');

            recognition.onresult = (event) => {
                input.value = event.results[0][0].transcript;
                translateWithAI();
            };

            recognition.start();
        }

        // –ù—É—Å—Ö–∞–±–∞—Ä–¥–æ—Ä”£
        function copyText() {
            navigator.clipboard.writeText(output.innerText);
            alert("–ù—É—Å—Ö–∞–±–∞—Ä–¥–æ—Ä”£ —à—É–¥!");
        }

        // –•–æ–Ω–¥–∞–Ω–∏ –º–∞—Ç–Ω (–û–≤–æ–∑)
        function playText() {
            const utterance = new SpeechSynthesisUtterance(output.innerText);
            const langMap = { 'Russian': 'ru-RU', 'English': 'en-US', 'German': 'de-DE' };
            utterance.lang = langMap[lTo.value] || 'en-US';
            window.speechSynthesis.speak(utterance);
        }
    </script>
</body>
</html>
